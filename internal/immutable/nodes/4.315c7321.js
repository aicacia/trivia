import{S as N,i as S,L as V,k as q,l as w,m as Q,h,n as I,b as D,P as ee,a4 as te,K as U,a as $,c as j,N as d,O as ne,D as re,q as A,r as B,u as oe,v as R,d as P,f as F,g as T,y as x,z,A as X,B as G,e as C,a1 as se,R as ie,o as le}from"../chunks/index.b32904f4.js";import{g as ae,u as ue,a as ce}from"../chunks/trivia.0a8a2609.js";import{X as fe}from"../chunks/index.fc72133f.js";import{g as _e}from"../chunks/navigation.1ded8cd7.js";import{e as de}from"../chunks/singletons.38b5dd91.js";const me=l=>({room_id:l.params.room_id}),De=Object.freeze(Object.defineProperty({__proto__:null,load:me},Symbol.toStringTag,{value:"Module"}));function J(l,e,n){const t=l.slice();return t[4]=e[n],t}function W(l,e){let n,t,r,s,o,i=e[4]+"",c,b,y;return{key:l,first:null,c(){n=q("div"),t=q("input"),s=$(),o=q("div"),c=$(),this.h()},l(u){n=w(u,"DIV",{class:!0});var a=Q(n);t=w(a,"INPUT",{type:!0}),s=j(a),o=w(a,"DIV",{});var p=Q(o);p.forEach(h),c=j(a),a.forEach(h),this.h()},h(){I(t,"type","checkbox"),t.checked=r=e[0]===e[4],I(n,"class","flex flex-row justify-start"),this.first=n},m(u,a){D(u,n,a),d(n,t),d(n,s),d(n,o),o.innerHTML=i,d(n,c),b||(y=ne(t,"change",function(){re(e[2](e[4]))&&e[2](e[4]).apply(this,arguments)}),b=!0)},p(u,a){e=u,a&3&&r!==(r=e[0]===e[4])&&(t.checked=r),a&2&&i!==(i=e[4]+"")&&(o.innerHTML=i)},d(u){u&&h(n),b=!1,y()}}}function pe(l){let e,n=[],t=new Map,r=l[1];const s=o=>o[4];for(let o=0;o<r.length;o+=1){let i=J(l,r,o),c=s(i);t.set(c,n[o]=W(c,i))}return{c(){e=q("div");for(let o=0;o<n.length;o+=1)n[o].c();this.h()},l(o){e=w(o,"DIV",{class:!0});var i=Q(e);for(let c=0;c<n.length;c+=1)n[c].l(i);i.forEach(h),this.h()},h(){I(e,"class","flex flex-col")},m(o,i){D(o,e,i);for(let c=0;c<n.length;c+=1)n[c]&&n[c].m(e,null)},p(o,[i]){i&7&&(r=o[1],n=ee(n,i,s,1,o,r,t,e,te,W,null,J))},i:U,o:U,d(o){o&&h(e);for(let i=0;i<n.length;i+=1)n[i].d()}}}function he(l,e,n){let t,{question:r}=e,s;function o(i){return c=>{n(0,s=i)}}return l.$$set=i=>{"question"in i&&n(3,r=i.question)},l.$$.update=()=>{l.$$.dirty&8&&n(1,t=Object.values(r.incorrect_answers).concat([r.correct_answer]))},[s,t,o,r]}class ge extends N{constructor(e){super(),S(this,e,he,pe,V,{question:3})}}function be(l){let e,n,t,r,s,o,i,c,b,y,u,a;return{c(){e=q("div"),n=q("div"),t=q("input"),r=$(),s=q("label"),o=A("True"),i=$(),c=q("div"),b=q("input"),y=$(),u=q("label"),a=A("False"),this.h()},l(p){e=w(p,"DIV",{class:!0});var v=Q(e);n=w(v,"DIV",{class:!0});var k=Q(n);t=w(k,"INPUT",{type:!0,name:!0}),r=j(k),s=w(k,"LABEL",{for:!0});var L=Q(s);o=B(L,"True"),L.forEach(h),k.forEach(h),i=j(v),c=w(v,"DIV",{class:!0});var _=Q(c);b=w(_,"INPUT",{type:!0,name:!0}),y=j(_),u=w(_,"LABEL",{for:!0});var m=Q(u);a=B(m,"False"),m.forEach(h),_.forEach(h),v.forEach(h),this.h()},h(){I(t,"type","checkbox"),I(t,"name","true"),I(s,"for","true"),I(n,"class","flex flex-row"),I(b,"type","checkbox"),I(b,"name","false"),I(u,"for","false"),I(c,"class","flex flex-row"),I(e,"class","flex flex-col")},m(p,v){D(p,e,v),d(e,n),d(n,t),d(n,r),d(n,s),d(s,o),d(e,i),d(e,c),d(c,b),d(c,y),d(c,u),d(u,a)},p:U,i:U,o:U,d(p){p&&h(e)}}}function ye(l,e,n){let{question:t}=e;return l.$$set=r=>{"question"in r&&n(0,t=r.question)},[t]}class ke extends N{constructor(e){super(),S(this,e,ye,be,V,{question:0})}}function ve(l){let e,n;return e=new ke({props:{question:l[0]}}),{c(){x(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,r){X(e,t,r),n=!0},p(t,r){const s={};r&1&&(s.question=t[0]),e.$set(s)},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){P(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function qe(l){let e,n;return e=new ge({props:{question:l[0]}}),{c(){x(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,r){X(e,t,r),n=!0},p(t,r){const s={};r&1&&(s.question=t[0]),e.$set(s)},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){P(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function we(l){let e,n,t=l[0].category+"",r,s,o,i=l[0].question+"",c,b,y,u,a,p;const v=[qe,ve],k=[];function L(_,m){return _[0].type==="multiple"?0:_[0].type==="boolean"?1:-1}return~(u=L(l))&&(a=k[u]=v[u](l)),{c(){e=q("div"),n=q("h3"),r=A(t),s=$(),o=q("p"),c=$(),b=q("hr"),y=$(),a&&a.c()},l(_){e=w(_,"DIV",{});var m=Q(e);n=w(m,"H3",{});var g=Q(n);r=B(g,t),g.forEach(h),s=j(m),o=w(m,"P",{});var f=Q(o);f.forEach(h),c=j(m),b=w(m,"HR",{}),y=j(m),a&&a.l(m),m.forEach(h)},m(_,m){D(_,e,m),d(e,n),d(n,r),d(e,s),d(e,o),o.innerHTML=i,d(e,c),d(e,b),d(e,y),~u&&k[u].m(e,null),p=!0},p(_,[m]){(!p||m&1)&&t!==(t=_[0].category+"")&&oe(r,t),(!p||m&1)&&i!==(i=_[0].question+"")&&(o.innerHTML=i);let g=u;u=L(_),u===g?~u&&k[u].p(_,m):(a&&(R(),P(k[g],1,1,()=>{k[g]=null}),F()),~u?(a=k[u],a?a.p(_,m):(a=k[u]=v[u](_),a.c()),T(a,1),a.m(e,null)):a=null)},i(_){p||(T(a),p=!0)},o(_){P(a),p=!1},d(_){_&&h(e),~u&&k[u].d()}}}function Ie(l,e,n){let{question:t}=e;return l.$$set=r=>{"question"in r&&n(0,t=r.question)},[t]}class Oe extends N{constructor(e){super(),S(this,e,Ie,we,V,{question:0})}}function H(l){const e=l.slice(),n=e[1][e[2]];return e[18]=n,e}function Y(l){let e,n,t=l[18]&&Z(l);return{c(){t&&t.c(),e=C()},l(r){t&&t.l(r),e=C()},m(r,s){t&&t.m(r,s),D(r,e,s),n=!0},p(r,s){r[18]?t?(t.p(r,s),s&6&&T(t,1)):(t=Z(r),t.c(),T(t,1),t.m(e.parentNode,e)):t&&(R(),P(t,1,1,()=>{t=null}),F())},i(r){n||(T(t),n=!0)},o(r){P(t),n=!1},d(r){t&&t.d(r),r&&h(e)}}}function Z(l){let e,n;return e=new Oe({props:{question:l[18]}}),{c(){x(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,r){X(e,t,r),n=!0},p(t,r){const s={};r&6&&(s.question=t[18]),e.$set(s)},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){P(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function Ee(l){let e,n,t,r;document.title=e="Trivia "+l[0].room_id.toUpperCase();let s=l[2]&&Y(H(l));return{c(){n=$(),s&&s.c(),t=C()},l(o){se("svelte-knelaq",document.head).forEach(h),n=j(o),s&&s.l(o),t=C()},m(o,i){D(o,n,i),s&&s.m(o,i),D(o,t,i),r=!0},p(o,[i]){(!r||i&1)&&e!==(e="Trivia "+o[0].room_id.toUpperCase())&&(document.title=e),o[2]?s?(s.p(H(o),i),i&4&&T(s,1)):(s=Y(H(o)),s.c(),T(s,1),s.m(t.parentNode,t)):s&&(R(),P(s,1,1,()=>{s=null}),F())},i(o){r||(T(s),r=!0)},o(o){P(s),r=!1},d(o){o&&h(n),s&&s.d(o),o&&h(t)}}}function Qe(l,e,n){let t,r,s;ie(l,ue,g=>n(8,s=g));let{data:o}=e;const i=ae(o.room_id);let c={},b,y,u={},a={},p,v;const k=new fe;function L(){const g=Object.keys(a);return g.length===0||g.length===Object.keys(u).length?null:k.fromArray(g).map(f=>f in u?L():f).unwrapOr(null)}let _=!1;async function m(){if(!_){_=!0;try{k.fromArray(Object.keys(c)).ifSome(O=>i.get("fetcher").set(O)),n(1,a=await ce(y)),i.get("questions").set(a);const f=L();f&&(n(2,p=f),i.get("currentQuestionId").set(p))}finally{_=!1}}}return le(()=>{const g=[i.get("results").on(async f=>{f&&(u=f)}),i.get("timePerQuestion").on(async f=>{}),i.get("seed").on(async f=>{f&&n(5,v=f)}),i.get("currentQuestionId").on(async f=>{f&&n(2,p=f)}),i.get("questions").on(async f=>{f&&n(1,a=(await Promise.all(Object.entries(f).map(async([O,E])=>{const M=await E;if(M){const K=await M.incorrect_answers;if(K)return[O,{...M,incorrect_answers:K}]}return null}))).filter(O=>!!O).reduce((O,[E,M])=>(M&&E&&(O[E]=M),O),{}))}),i.get("getQuestionsOptions").on(async f=>{f&&n(4,y=f)}),i.get("fetcher").on(async f=>{f&&n(3,b=f)}),i.get("users").on(async f=>{f&&(c=(await Promise.all(Object.values(f))).reduce((O,E)=>(E&&E.id&&(E.name||(E.name=""),O[E.id]=E),O),{}))})];return()=>{for(const f of g)f()}}),l.$$set=g=>{"data"in g&&n(0,o=g.data)},l.$$.update=()=>{l.$$.dirty&256&&n(6,t=s),l.$$.dirty&64&&i.get("users").get(t),l.$$.dirty&32&&v&&k.setSeed(v),l.$$.dirty&48&&n(7,r=v&&y),l.$$.dirty&145&&r&&!y.token&&_e(`${de}/${o.room_id}/lobby`),l.$$.dirty&218&&r&&y.token&&t===b&&!Object.keys(a).length&&m()},[o,a,p,b,y,v,t,r,s]}class Me extends N{constructor(e){super(),S(this,e,Qe,Ee,V,{data:0})}}export{Me as component,De as universal};
